# Configuration for NFL Play Suggestion & Trajectory Generation Models

# Data paths
data_dir: "data"

# Train/val/test splits (by week)
splits:
  by: "week"
  train: [1, 2, 3, 4, 5, 6]
  val: [7]
  test: [8]

# ============================================================================
# TRAJECTORY GENERATION SETTINGS (for autoregressive & diffusion models)
# ============================================================================

trajectories:
  use_tracking: true
  fps: 10                    # Tracking data frame rate
  max_timesteps: 60          # Truncate or pad sequences to this length (matches diffusion)
  players: "all"             # Use all players (22 = 11 offense + 11 defense)
  num_players: 22            # Number of players (22 = 11 offense + 11 defense, matches diffusion)
  include_velocity: false    # Use 3 features (x, y, s) to match diffusion
  condition_on_state: true   # Condition on game state (down, distance, etc.)

# Autoregressive model hyperparameters
autoregressive:
  # Training settings
  batch_size: 64            # Increased for faster training
  learning_rate: 0.001
  weight_decay: 0.0001
  epochs: 50
  early_stopping_patience: 999  # Disabled - will train for all epochs
  scheduler: "cosine"        # 'cosine', 'step', 'none'
  
  # LSTM configuration
  lstm:
    hidden_dim: 256
    num_layers: 2
    dropout: 0.1
    bidirectional: false
  
  # Transformer configuration
  transformer:
    d_model: 256
    nhead: 8
    num_layers: 4
    dim_feedforward: 512
    dropout: 0.1
    max_len: 100

# ============================================================================
# AUXILIARY PLAY SUGGESTION MODELS (non-generative baselines)
# ============================================================================

# Feature settings for play suggestion
features:
  use_presnap_shape: false   # Set to true for Baseline 1.5
  feature_weights:
    yardsToGo: 1.5
    yardline_100: 1.5

# Auxiliary baseline models (for play-level decisions, not trajectory generation)
baselines:
  knn:
    k: 50
    metric: "euclidean"
    algorithm: "ball_tree"
  
  bucket:
    # Bucket policy uses default bucketing scheme
    pass
  
  linear:
    ridge_alpha: 1.0
    logit_C: 1.0
    logit_class_weight: "balanced"

# ============================================================================
# EVALUATION SETTINGS
# ============================================================================

eval:
  # Trajectory metrics
  trajectory:
    compute_ade: true        # Average Displacement Error
    compute_fde: true        # Final Displacement Error
    compute_collision: true  # Collision rate
    compute_speed_dist: true # Speed distribution matching
  
  # Play suggestion metrics (legacy)
  play_suggestion:
    top_k: 10
    run_cpe: true            # Counterfactual Policy Evaluation

# ============================================================================
# OUTPUT SETTINGS
# ============================================================================

output:
  artifacts_dir: "artifacts"
  autoregressive_dir: "artifacts/autoregressive"
  save_models: true
  log_interval: 100          # Log every N batches
